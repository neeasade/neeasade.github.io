<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>search term playlists</title>
<meta name="generator" content="Org Mode" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
<meta property="og:title" content="search term playlists">
<meta property="og:description" content="">
<meta property="og:image" content="https://notes.neeasade.net/assets/img/backgrounds/newfeather.png">
<meta property="og:url" content="https://neeasade.net/">
<meta property="description" content="">
<meta name="twitter:card" content="summary">
<script src="/assets/js/linktext.js" defer></script>
<script src="../published/assets/js/linktext.js" defer></script>
<script src="/assets/js/copy.js" defer></script>
<script src="../published/assets/js/copy.js" defer></script>
<script data-goatcounter="https://neeasade.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script src="//instant.page/5.1.0" type="module" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
<link rel='stylesheet' href='/assets/css/colors.css?sum=495589c982e6b68f1a8adabc54e44dda'>
<link rel='stylesheet' href='./assets/css/colors.css?sum=495589c982e6b68f1a8adabc54e44dda'>
<link rel='stylesheet' href='/assets/css/normalize.css?sum=112272e51c80ffe5bd01becd2ce7d656'>
<link rel='stylesheet' href='./assets/css/normalize.css?sum=112272e51c80ffe5bd01becd2ce7d656'>
<link rel='stylesheet' href='/assets/css/magick.css?sum=e67dc754cb3ed386e2529c61f1b67ed6'>
<link rel='stylesheet' href='./assets/css/magick.css?sum=e67dc754cb3ed386e2529c61f1b67ed6'>
<link rel='stylesheet' href='/assets/css/notes.css?sum=b0b2b506dac76f261785d157f35d3622'>
<link rel='stylesheet' href='./assets/css/notes.css?sum=b0b2b506dac76f261785d157f35d3622'>
</head>
<body>
<main id="content" class="content">
<header>
<div style="float: left">
    <a href='./index.html'>../notes</a>
</div>

<div style="float: right">
    
    <a href="https://raw.githubusercontent.com/neeasade/neeasade.github.io/source/posts/2020-12-13-search-term-playlists.org">source</a>
</div>
<h1 class=title>
    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
        <rect x="5" y="15" width="20" height="20" fill="none" stroke="#5a5a5a" stroke-width="2"/>
        <rect x="14" y="6" width="20" height="20" fill="none" stroke="#5a5a5a" stroke-width="2"/>
    </svg>
    search term playlists
    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
        <rect x="5" y="15" width="20" height="20" fill="none" stroke="#5a5a5a" stroke-width="2"/>
        <rect x="14" y="6" width="20" height="20" fill="none" stroke="#5a5a5a" stroke-width="2"/>
    </svg>
</h1>
<div class="org-center">
<p>

</p>
</div>
<span class=pubinfo>
    Published 2020-12-13,
    last edit <a href="https://github.com/neeasade/neeasade.github.io/commits/source/posts/2020-12-13-search-term-playlists.org">2022-07-09</a>
</span>
<div class="posttags"> <a href='./tag-youtube-dl.html'>#youtube-dl</a><a href='./tag-music.html'>#music</a><a href='./tag-bash.html'>#bash</a> </div>
</header>
<hr>
<p>
This is a brief overview of how I manage a local music collection in <code>$current_year</code>. I use Music Player Daemon (MPD) and youtube-dl to index and add music to big &ldquo;local music&rdquo; folder. Over the years structure is totally scattered, but at least for the import folder (youtube-dl) things always look like this: <code>${musicdir}/import/&lt;channel&gt;/&lt;title&gt;</code>. MPD has many clients, but now I use a script that operates atop the mpc client.
</p>

<p>
For quite sometime, my music playing looked like this:
</p>

<div class="org-src-container">
<pre class="src src-sh">mpc clear
mpc listall | sort -R | head -n 1000 | mpc add
</pre>
</div>

<p>
As you might imagine, this can lead to some jarring transitions and inconsistency with the 𝓜𝓞𝓞𝓓.
</p>

<p>
MPD has a notion of saving and loading playlists, but you have to add files individually to them/it&rsquo;s a very tedious experience if you want to incorporate many kinds of vibes.
</p>

<p>
Enter my version of playlist files.
</p>

<p>
Playlist files are files where every line is a comment, except for lines starting with <code>+</code> or <code>-</code>. At the moment, here is my jazz_piano playlist:
</p>

<div class="org-src-container">
<pre class="src src-conf"><span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">artists</span>
+ryo fukui
+hiromi
+gabor szabo
+kitajima
+hitotaka izumi
+Minoru Muraoka
+alice coltrane

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">albums</span>
+flight to brazil

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">generic</span>
+piano
+jazz
+koto

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">channel</span>
+mogurin3131
+mogurin313131
+marcel the drunkard

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">edd ed eddy is actually pretty jazzy</span>
+ed, edd

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">random</span>
+touhou

-05 My Sick Piano.m4a
-Mario Basanov &amp; Vidis  - I<span style="color: #cb7000;">'ll Be Gone (ft. Jazzu) _ Chill_Deep-6zaOfkd84Z0.m4a</span>
<span style="color: #cb7000;">-Dubmood - Bored at the piano-vQUlWsU_yZ4.m4a</span>
</pre>
</div>

<p>
Lines that start with a <code>+</code> are search terms against the current music collection (with a lenient grep against <code>mpc listall</code>) and lines that start with <code>-</code> are to remove search matches from the current <code>mpc playlist</code>. Removal is necessary because some search terms are so generic (here, piano). I then give <code>music</code> a function to process all the search matches. The advantage to this approach is whenever I add new stuff from an above artist or YouTube channel, it will automatically get added to the playlist!
</p>

<p>
The script may be found <a href="https://github.com/neeasade/dotfiles/blob/master/bin/bin/music">here</a>. Here are it&rsquo;s current options:
</p>
<pre class="example" id="org97bf810">
$ music
music options:
add        : add a url to library, fallback on clipboard content
append     : append some search term to the current playlist
artist     : play songs by an artist
bl         : blacklist the currently playing song from the current playlist
del        : delete the currently playing song
filter     : filter the current playlist by some shell function acting on music files
info       : display the current audio progress bar and playlist length
now        : fuzzy search for a song, play it now
playlist   : select a search term based playlist to play
remove     : remove some search match from the playlist
shuffle    : reshuffle current selection from all
</pre>

<p>
And an example of a fetch-like status (bar created with <a href="https://github.com/neeasade/dotfiles/blob/master/wm/.wm/panel/tools/mkb">mkb</a>):
</p>
<pre class="example" id="org9f25d5e">
$ music info
Hiromi Uehara 2006 Love and Laughter
◈◈◈◈◈◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇
playlist: jazz_piano | 60h 35m 13s
</pre>

<div class=separator> ∗ ∗ ∗ </div>

<p>
After some times passed with the above system, I found myself sometimes wanting more flexibility in playlist composition. Did you know you that <code>-</code> and <code>+</code> are valid function names in bash? Oh yes, we&rsquo;re going to get dumb:
</p>

<div class="org-src-container">
<pre class="src src-sh">+ () { append <span style="color: #cb7000;">"$@"</span>; }
<span style="color: #0095ac;">-</span> () { remove <span style="color: #cb7000;">"$@"</span>; }
@ () { artist <span style="color: #cb7000;">"$@"</span>; }
<span style="color: #5a5a5a;">.</span> <span style="color: #cb7000;">"/path/to/playlist"</span>
</pre>
</div>

<p>
Sourcing the playlist means the blend between music script and playlist is total, because playlists are now just shell scripts eval&rsquo;d in the `music` context. What follows is my vaporwave playlist, where you can see I&rsquo;m doing something silly and effective with ｗｉｄｅｃｈａｒｓ:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8a8a8a;">#</span><span style="color: #8a8a8a;">!/bin/</span><span style="color: #5a5a5a;">sh</span>

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">get any song with a widechar in its name</span>
<span style="color: #5a5a5a;">for</span> x<span style="color: #5a5a5a;"> in</span> &#65345; &#65346; &#65347; &#65348; &#65349; &#65350; &#65351; &#65352; &#65353; &#65354; &#65355; &#65356; &#65357; &#65358; &#65359; &#65360; &#65361; &#65362; &#65363; &#65364; &#65365; &#65366; &#65361; &#65368; &#65369; &#65370; &#65313; &#65314; &#65315; &#65316; &#65317; &#65318; &#65319; &#65320; &#65321; &#65322; &#65323; &#65324; &#65325; &#65326; &#65327; &#65328; &#65329; &#65330; &#65331; &#65332; &#65333; &#65334; &#65329; &#65336; &#65337; &#65338;; <span style="color: #5a5a5a;">do</span>
   append $<span style="color: #0095ac;">x</span>
<span style="color: #5a5a5a;">done</span>

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">artists</span>
@ HOME
@ windows96
@ lucien hughes
@ Macintosh Plus
@ haircuts for men
@ blank banshee

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">search terms</span>
+ vaporwave
+ vapor
+ E m o t i o n a l T o k y o

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">youtube channel</span>
+ elfamosodemon

<span style="color: #8a8a8a;"># </span><span style="color: #8a8a8a;">give us stuff longer than 15min</span>
filter is_long

- lazerhawk
- saint pepsi
- lofi
- synthwave
</pre>
</div>

<p>
This degree of control is fun because I can do things like &ldquo;make a playlist of songs not listed in any other playlists&rdquo; in addition to just being selective about broad searches.
</p>

<p>
Have fun with it! 🐨
</p>

<footer>
    <div style="float: left">
         <a href='printing-and-scanning-on-linux.html'>newer: printing and scanning on linux</a> 
    </div>
    <div style="text-align: right">
         <a href='o7.html'>older: o7</a> 
    </div>
</footer>
<hr>
</main>
</body>
</html>
