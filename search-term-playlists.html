<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-07-10 Sun 15:22 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>search term playlists</title>
<meta name="generator" content="Org Mode" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:title" content="search term playlists">
<meta property="og:description" content="">
<meta property="description" content="">
<meta property="og:image" content="https://notes.neeasade.net/assets/img/backgrounds/warm.png">
<meta property="og:url" content="/home/neeasade/git/neeasade.github.io/site/search-term-playlists.html">
<meta name="twitter:card" content="summary">
<script src="/assets/js/linktext.js" defer></script>
<script data-goatcounter="https://neeasade.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script src="//instant.page/5.1.0" type="module" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
<link rel='stylesheet' href='/assets/css/colors.css?sum=294447da8445d35e73a488312b1905d3'>
<link rel='stylesheet' href='./assets/css/colors.css?sum=294447da8445d35e73a488312b1905d3'>
<link rel='stylesheet' href='/assets/css/new.css?sum=4868ab8522b4e4059bfc5213fd799d61'>
<link rel='stylesheet' href='./assets/css/new.css?sum=4868ab8522b4e4059bfc5213fd799d61'>
<link rel='stylesheet' href='/assets/css/org.css?sum=19824060f71383b34e196f76ea8c38f1'>
<link rel='stylesheet' href='./assets/css/org.css?sum=19824060f71383b34e196f76ea8c38f1'>
<link rel='stylesheet' href='/assets/css/notes.css?sum=c01a640d99c7eef2196634061985d6ff'>
<link rel='stylesheet' href='./assets/css/notes.css?sum=c01a640d99c7eef2196634061985d6ff'>
</head>
<body>
<div id="content" class="content">
<div style="float: left">
    <a href='/index.html'>Up: 𝔊𝔄𝔗𝔈𝔚𝔄𝔜⟴</a>
</div>

<div style="float: right">
    <a href="https://github.com/neeasade/neeasade.github.io/commits/source/posts/2020-12-13-search-term-playlists.org">Last edit: <2022-07-09></a>
</div>

<p>
<h1 class=title>search term playlists</h1>
</p>


<hr>

<p>
This is a brief overview of how I manage a local music collection in <code>$current_year</code>. I use Music Player Daemon (MPD) and youtube-dl to index and add music to big &ldquo;local music&rdquo; folder. Over the years structure is totally scattered, but at least for the import folder (youtube-dl) things always look like this: <code>${musicdir}/import/&lt;channel&gt;/&lt;title&gt;</code>. MPD has many clients, but now I use a script that operates atop the mpc client.
</p>

<p>
For quite sometime, my music playing looked like this:
</p>

<div class="org-src-container">
<pre class="src src-sh">mpc clear
mpc listall | sort -R | head -n 1000 | mpc add
</pre>
</div>

<p>
As you might imagine, this can lead to some jarring transitions and inconsistency with the 𝓜𝓞𝓞𝓓.
</p>

<p>
MPD has a notion of saving and loading playlists, but you have to add files individually to them/it&rsquo;s a very tedious experience if you want to incorporate many kinds of vibes.
</p>

<p>
Enter my version of playlist files.
</p>

<p>
Playlist files are files where every line is a comment, except for lines starting with <code>+</code> or <code>-</code>. At the moment, here is my jazz_piano playlist:
</p>

<div class="org-src-container">
<pre class="src src-conf"><span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">artists</span>
+ryo fukui
+hiromi
+gabor szabo
+kitajima
+hitotaka izumi
+Minoru Muraoka
+alice coltrane

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">albums</span>
+flight to brazil

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">generic</span>
+piano
+jazz
+koto

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">channel</span>
+mogurin3131
+mogurin313131
+marcel the drunkard

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">edd ed eddy is actually pretty jazzy</span>
+ed, edd

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">random</span>
+touhou

-05 My Sick Piano.m4a
-Mario Basanov &amp; Vidis  - I<span style="color: #5b6600;">'ll Be Gone (ft. Jazzu) _ Chill_Deep-6zaOfkd84Z0.m4a</span>
<span style="color: #5b6600;">-Dubmood - Bored at the piano-vQUlWsU_yZ4.m4a</span>
</pre>
</div>

<p>
Lines that start with a <code>+</code> are search terms against the current music collection (with a lenient grep against <code>mpc listall</code>) and lines that start with <code>-</code> are to remove search matches from the current <code>mpc playlist</code>. Removal is necessary because some search terms are so generic (here, piano). I then give <code>music</code> a function to process all the search matches. The advantage to this approach is whenever I add new stuff from an above artist or YouTube channel, it will automatically get added to the playlist!
</p>

<p>
The script may be found <a href="https://github.com/neeasade/dotfiles/blob/master/bin/bin/music">here</a>. Here are it&rsquo;s current options:
</p>
<pre class="example" id="org2af8185">
$ music
music options:
add        : add a url to library, fallback on clipboard content
append     : append some search term to the current playlist
artist     : play songs by an artist
bl         : blacklist the currently playing song from the current playlist
del        : delete the currently playing song
filter     : filter the current playlist by some shell function acting on music files
info       : display the current audio progress bar and playlist length
now        : fuzzy search for a song, play it now
playlist   : select a search term based playlist to play
remove     : remove some search match from the playlist
shuffle    : reshuffle current selection from all
</pre>

<p>
And an example of a fetch-like status (bar created with <a href="https://github.com/neeasade/dotfiles/blob/master/wm/.wm/panel/tools/mkb">mkb</a>):
</p>
<pre class="example" id="orga4d936d">
$ music info
Hiromi Uehara 2006 Love and Laughter
◈◈◈◈◈◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇◇
playlist: jazz_piano | 60h 35m 13s
</pre>


<div class="org-center">
<p>
🪨 🪨 🪨
</p>
</div>


<p>
After some times passed with the above system, I found myself sometimes wanting more flexibility in playlist composition. Did you know you that <code>-</code> and <code>+</code> are valid function names in bash? Oh yes, we&rsquo;re going to get dumb:
</p>

<div class="org-src-container">
<pre class="src src-sh">+ () { append <span style="color: #5b6600;">"$@"</span>; }
<span style="color: #825072;">-</span> () { remove <span style="color: #5b6600;">"$@"</span>; }
@ () { artist <span style="color: #5b6600;">"$@"</span>; }
<span style="color: #1d6a76;">.</span> <span style="color: #5b6600;">"/path/to/playlist"</span>
</pre>
</div>

<p>
Sourcing the playlist means the blend between music script and playlist is total, because playlists are now just shell scripts eval&rsquo;d in the `music` context. What follows is my vaporwave playlist, where you can see I&rsquo;m doing something silly and effective with ｗｉｄｅｃｈａｒｓ:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #a93b2f;">#</span><span style="color: #a93b2f;">!/bin/</span><span style="color: #1d6a76;">sh</span>

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">get any song with a widechar in its name</span>
<span style="color: #1d6a76;">for</span> x<span style="color: #1d6a76;"> in</span> &#65345; &#65346; &#65347; &#65348; &#65349; &#65350; &#65351; &#65352; &#65353; &#65354; &#65355; &#65356; &#65357; &#65358; &#65359; &#65360; &#65361; &#65362; &#65363; &#65364; &#65365; &#65366; &#65361; &#65368; &#65369; &#65370; &#65313; &#65314; &#65315; &#65316; &#65317; &#65318; &#65319; &#65320; &#65321; &#65322; &#65323; &#65324; &#65325; &#65326; &#65327; &#65328; &#65329; &#65330; &#65331; &#65332; &#65333; &#65334; &#65329; &#65336; &#65337; &#65338;; <span style="color: #1d6a76;">do</span>
   append $<span style="color: #825072;">x</span>
<span style="color: #1d6a76;">done</span>

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">artists</span>
@ HOME
@ windows96
@ lucien hughes
@ Macintosh Plus
@ haircuts for men
@ blank banshee

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">search terms</span>
+ vaporwave
+ vapor
+ E m o t i o n a l T o k y o

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">youtube channel</span>
+ elfamosodemon

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">give us stuff longer than 15min</span>
filter is_long

- lazerhawk
- saint pepsi
- lofi
- synthwave
</pre>
</div>

<p>
This degree of control is fun because I can do things like &ldquo;make a playlist of songs not listed in any other playlists&rdquo; in addition to just being selective about broad searches.
</p>

<p>
Have fun with it! 🐨
</p>


<p>
<div class='title flair'><img class='flair-border' src='./assets/img/backgrounds/pattern_125.gif' /> </div>
</p>

<div class='footer-left'>
    <a href='/index.html'>𝔊𝔄𝔗𝔈𝔚𝔄𝔜⟴</a>
</div>

<p>
<div class=footer-center>type: post</div>
</p>

<div class="footer-right">
    <a href="https://raw.githubusercontent.com/neeasade/neeasade.github.io/source/posts/2020-12-13-search-term-playlists.org">Page Markup</a>
</div>
</div>
</body>
</html>
