<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-07-10 Sun 15:22 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sxhkd-ish</title>
<meta name="generator" content="Org Mode" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:title" content="sxhkd-ish">
<meta property="og:description" content="another place the shell lives forever">
<meta property="description" content="another place the shell lives forever">
<meta property="og:image" content="https://notes.neeasade.net/assets/img/backgrounds/warm.png">
<meta property="og:url" content="/home/neeasade/git/neeasade.github.io/site/sxhkd-ish.html">
<meta name="twitter:card" content="summary">
<script src="/assets/js/linktext.js" defer></script>
<script data-goatcounter="https://neeasade.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script src="//instant.page/5.1.0" type="module" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
<link rel='stylesheet' href='/assets/css/colors.css?sum=294447da8445d35e73a488312b1905d3'>
<link rel='stylesheet' href='./assets/css/colors.css?sum=294447da8445d35e73a488312b1905d3'>
<link rel='stylesheet' href='/assets/css/new.css?sum=4868ab8522b4e4059bfc5213fd799d61'>
<link rel='stylesheet' href='./assets/css/new.css?sum=4868ab8522b4e4059bfc5213fd799d61'>
<link rel='stylesheet' href='/assets/css/org.css?sum=19824060f71383b34e196f76ea8c38f1'>
<link rel='stylesheet' href='./assets/css/org.css?sum=19824060f71383b34e196f76ea8c38f1'>
<link rel='stylesheet' href='/assets/css/notes.css?sum=c01a640d99c7eef2196634061985d6ff'>
<link rel='stylesheet' href='./assets/css/notes.css?sum=c01a640d99c7eef2196634061985d6ff'>
</head>
<body>
<div id="content" class="content">
<div style="float: left">
    <a href='/index.html'>Up: 𝔊𝔄𝔗𝔈𝔚𝔄𝔜⟴</a>
</div>

<div style="float: right">
    <a href="https://github.com/neeasade/neeasade.github.io/commits/source/posts/sxhkd-ish.org">Last edit: <2021-01-26></a>
</div>

<p>
<h1 class=title>sxhkd-ish</h1>
</p>

<div class="org-center">
<p>
another place the shell lives forever
</p>
</div>


<hr>

<p>
For years now, I&rsquo;ve used bspwm as my daily driver window manager. It does not ship with a builtin way to set keybindings &#x2013; instead, the recommended path is to use another program by it&rsquo;s author, <a href="https://github.com/baskerville/sxhkd/">sxhkd</a>, to bind key presses to process calls. Such calls are launched with <code>SHELL -c COMMAND</code>, where <code>SHELL</code> is set by <code>$SXHKD_SHELL</code>  or <code>$SHELL</code>. Here&rsquo;s a pair of bindings from my <a href="https://github.com/neeasade/dotfiles/blob/a6bbfdad1fc8982bcedbb6e9449823b935d4a166/sxhkd/.config/sxhkd/sxhkdrc#L1">sxhkdrc</a>:
</p>

<div class="org-src-container">
<pre class="src src-conf">super + Escape
    notify-send <span style="color: #5b6600;">"reloading sxhkd!"</span>; pkill -USR1 -x sxhkd

super + {_,shift,alt,ctrl} + {h,n,e,l}
    {focus,move,resize,presel}.sh {west,south,north,east}
</pre>
</div>

<p>
One of sxhkd&rsquo;s most attractive features for me is the slick templating you can have. That second example assigns my preferred directional keys (<a href="./colemak-dh-mod.html">colemak-dhk</a>) to call scripts assigned to do different actions. The full expansion is as follows:
</p>

<div class="org-src-container">
<pre class="src src-conf">super + h
    focus.sh west
super + n
    focus.sh south
super + e
    focus.sh north
super + l
    focus.sh east
super + shift + h
    move.sh west
super + shift + n
    move.sh south
super + shift + e
    move.sh north
super + shift + l
    move.sh east
super + alt + h
    resize.sh west
super + alt + n
    resize.sh south
super + alt + e
    resize.sh north
super + alt + l
    resize.sh east
super + ctrl + h
    presel.sh west
super + ctrl + n
    presel.sh south
super + ctrl + e
    presel.sh north
super + ctrl + l
    presel.sh east
</pre>
</div>

<p>
WEW that&rsquo;s a lot. Thanks Baskerbae.
</p>


<div class="org-center">
<p>
🪨 🪨 🪨
</p>
</div>


<p>
Many of the newer wayland window managers have you assign keys individually via a client, mostly in a shape that sort of hails from the i3 config format. I&rsquo;ll cherrypick <a href="https://github.com/swaywm/sway/blob/4d43f1dd996e61e38d89adf0ad1435dac32e38a5/config.in#L90">sway</a>&rsquo;s, but you can see comparable formats in example configs for <a href="https://gitlab.com/cardboardwm/cardboard/-/blob/f2ef2ff076ddbbd23994553b8eff131f9bd0207f/README.md">cardboard</a>, <a href="https://github.com/ifreund/river/blob/afe1f197aa8f80f5fb0069aeaf851240189f9dcc/example/init">river</a>, and <a href="https://github.com/ifreund/river/blob/afe1f197aa8f80f5fb0069aeaf851240189f9dcc/example/init">wayfire</a> as well:
</p>

<div class="org-src-container">
<pre class="src src-conf">bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
</pre>
</div>

<p>
This snippet comes from the example config, but if you prepend the lines with <code>swaymsg</code> you get something you can run in a script. In the week or so I gave sway a drive, most of my configuring was done this way &#x2013; with a <code>swayrc</code> file containing <code>swaymsg</code> client calls &#x2013; the prospect of porting my comparably compact sxhkdrc file was annoying though. So, like the lazy programmer I am, I squinted at it a little bit and realized the sxhkd templating format looked a little&#x2026; <i>familiar</i>. It&rsquo;s supremely similar to shell templating!:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ echo foo{bar,baz}
foobar foobaz

$ echo {,fae}{bar,baz}
foobar foobaz faebar faebaz

$ echo super+{_,shift,alt,ctrl}+{h,n,e,l}
super+_+h super+_+n super+_+e super+_+l super+shift+h super+shift+n super+shift+e super+shift+l super+alt+h super+alt+n super+alt+e super+alt+l super+ctrl+h super+ctrl+n super+ctrl+e super+ctrl+l
</pre>
</div>

<p>
Armed with this knowledge, I glued together something terrible for my <code>swayrc</code> file:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #1d6a76;">bind</span>() {
    <span style="color: #825072;">args</span>=(<span style="color: #5b6600;">"$@"</span>)
    <span style="color: #1d6a76;">for</span> i<span style="color: #1d6a76;"> in</span> $(seq 0 "$(( (${#args[@]} / 2<span style="color: #5b6600;">) - 1 ))"</span>); <span style="color: #1d6a76;">do</span>
        <span style="color: #825072;">key</span>=$(echo "${args[$i]}" | sed 's/super/Mod4/' )

        <span style="color: #825072;">val_index</span>=$(( i + (${#args[@]} / 2) ))
        <span style="color: #825072;">val</span>=${<span style="color: #825072;">args</span>[$<span style="color: #825072;">val_index</span>]}

        <span style="color: #1d6a76;">echo</span> swaymsg bindsym <span style="color: #5b6600;">"$key"</span> <span style="color: #5b6600;">"$bindprefix$val"</span>
        swaymsg bindsym <span style="color: #5b6600;">"$key"</span> <span style="color: #5b6600;">"$bindprefix$val"</span>
    <span style="color: #1d6a76;">done</span>
}

<span style="color: #a93b2f;"># </span><span style="color: #a93b2f;">bind exec</span>
<span style="color: #825072;">binde</span>() {
    <span style="color: #825072;">bindprefix</span>=<span style="color: #5b6600;">'exec '</span> bind <span style="color: #5b6600;">"$@"</span>
}
</pre>
</div>

<p>
And then, as long as I escaped the spaces to connect the terms, I could get away with this as my config:
</p>

<div class="org-src-container">
<pre class="src src-sh">binde super+{,shift+,alt+,ctrl+}{h,n,e,l} <span style="color: #667400;">\</span>
    {focus,move,resize,presel}.sh<span style="color: #5b6600;">\ </span>{west,south,north,east}
</pre>
</div>

<p>
Hooray!
</p>


<p>
<div class='title flair'><img class='flair-border' src='./assets/img/backgrounds/pattern_125.gif' /> </div>
</p>

<div class='footer-left'>
    <a href='/index.html'>𝔊𝔄𝔗𝔈𝔚𝔄𝔜⟴</a>
</div>

<p>
<div class=footer-center>type: post</div>
</p>

<div class="footer-right">
    <a href="https://raw.githubusercontent.com/neeasade/neeasade.github.io/source/posts/sxhkd-ish.org">Page Markup</a>
</div>
</div>
</body>
</html>
