<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sxhkd-ish</title>
<meta name="generator" content="Org Mode" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
<meta property="og:title" content="sxhkd-ish">
<meta property="og:description" content="another place the shell lives forever">
<meta property="og:image" content="https://notes.neeasade.net/assets/img/backgrounds/newfeather.png">
<meta property="og:url" content="https://notes.neeasade.net/sxhkd-ish.html">
<meta property="description" content="another place the shell lives forever">
<meta name="twitter:card" content="summary">
<script src="/assets/js/linktext.js" defer></script>
<script src="/assets/js/copy.js" defer></script>
<script src="../published/assets/js/linktext.js" defer></script>
<script src="../published/assets/js/copy.js" defer></script>
<script data-goatcounter="https://neeasade.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
<script src="//instant.page/5.1.0" type="module" integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
<link rel='stylesheet' href='/assets/css/colors.css?sum=4e25672ec2152636a22f5871b20bed87'>
<link rel='stylesheet' href='./assets/css/colors.css?sum=4e25672ec2152636a22f5871b20bed87'>
<link rel='stylesheet' href='/assets/css/normalize.css?sum=112272e51c80ffe5bd01becd2ce7d656'>
<link rel='stylesheet' href='./assets/css/normalize.css?sum=112272e51c80ffe5bd01becd2ce7d656'>
<link rel='stylesheet' href='/assets/css/magick.css?sum=e71339f4a35fb23b9f6ddf718c2bfb68'>
<link rel='stylesheet' href='./assets/css/magick.css?sum=e71339f4a35fb23b9f6ddf718c2bfb68'>
<link rel='stylesheet' href='/assets/css/notes.css?sum=1f67d718068486e8ae9efb2c0f7c6c87'>
<link rel='stylesheet' href='./assets/css/notes.css?sum=1f67d718068486e8ae9efb2c0f7c6c87'>
</head>
<body>
<main id="content" class="content">
<header>
<div style="float: left">
    <a href='/index.html'>../ＳＴＸ</a>
</div>

<div style="float: right">
    
    <a href="https://raw.githubusercontent.com/neeasade/neeasade.github.io/source/posts/sxhkd-ish.org">source</a>
</div>
<h1 class=title>
    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
        <rect x="5" y="15" width="20" height="20" fill="none" stroke="#5a5a5a" stroke-width="2"/>
        <rect x="14" y="6" width="20" height="20" fill="none" stroke="#5a5a5a" stroke-width="2"/>
    </svg>
    sxhkd-ish
    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
        <rect x="5" y="15" width="20" height="20" fill="none" stroke="#5a5a5a" stroke-width="2"/>
        <rect x="14" y="6" width="20" height="20" fill="none" stroke="#5a5a5a" stroke-width="2"/>
    </svg>
</h1>
<div class="org-center">
<p>
another place the shell lives forever
</p>
</div>
<span class=pubinfo>
    Published 2021-01-26,
    last edit <a href="https://github.com/neeasade/neeasade.github.io/commits/source/posts/sxhkd-ish.org">2022-07-20</a>
</span>
</header>
<hr>
<p>
For years now, I&rsquo;ve used bspwm as my daily driver window manager. It does not ship with a builtin way to set keybindings &#x2013; instead, the recommended path is to use another program by it&rsquo;s author, <a href="https://github.com/baskerville/sxhkd/">sxhkd</a>, to bind key presses to process calls. Such calls are launched with <code>SHELL -c COMMAND</code>, where <code>SHELL</code> is set by <code>$SXHKD_SHELL</code>  or <code>$SHELL</code>. Here&rsquo;s a pair of bindings from my <a href="https://github.com/neeasade/dotfiles/blob/a6bbfdad1fc8982bcedbb6e9449823b935d4a166/sxhkd/.config/sxhkd/sxhkdrc#L1">sxhkdrc</a>:
</p>

<div class="org-src-container">
<pre class="src src-conf">super + Escape
    notify-send <span style="color: #007c00;">"reloading sxhkd!"</span>; pkill -USR1 -x sxhkd

super + {_,shift,alt,ctrl} + {h,n,e,l}
    {focus,move,resize,presel}.sh {west,south,north,east}
</pre>
</div>

<p>
One of sxhkd&rsquo;s most attractive features for me is the slick templating you can have. That second example assigns my preferred directional keys (<a href="./colemak-dh-mod.html">colemak-dhk</a>) to call scripts assigned to do different actions. The full expansion is as follows:
</p>

<div class="org-src-container">
<pre class="src src-conf">super + h
    focus.sh west
super + n
    focus.sh south
super + e
    focus.sh north
super + l
    focus.sh east
super + shift + h
    move.sh west
super + shift + n
    move.sh south
super + shift + e
    move.sh north
super + shift + l
    move.sh east
super + alt + h
    resize.sh west
super + alt + n
    resize.sh south
super + alt + e
    resize.sh north
super + alt + l
    resize.sh east
super + ctrl + h
    presel.sh west
super + ctrl + n
    presel.sh south
super + ctrl + e
    presel.sh north
super + ctrl + l
    presel.sh east
</pre>
</div>

<p>
WEW that&rsquo;s a lot. Thanks Baskerbae.
</p>

<div class=separator> ∗ ∗ ∗ </div>

<p>
Many of the newer wayland window managers have you assign keys individually via a client, mostly in a shape that sort of hails from the i3 config format. I&rsquo;ll cherrypick <a href="https://github.com/swaywm/sway/blob/4d43f1dd996e61e38d89adf0ad1435dac32e38a5/config.in#L90">sway</a>&rsquo;s, but you can see comparable formats in example configs for <a href="https://gitlab.com/cardboardwm/cardboard/-/blob/f2ef2ff076ddbbd23994553b8eff131f9bd0207f/README.md">cardboard</a>, <a href="https://github.com/ifreund/river/blob/afe1f197aa8f80f5fb0069aeaf851240189f9dcc/example/init">river</a>, and <a href="https://github.com/ifreund/river/blob/afe1f197aa8f80f5fb0069aeaf851240189f9dcc/example/init">wayfire</a> as well:
</p>

<div class="org-src-container">
<pre class="src src-conf">bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
</pre>
</div>

<p>
This snippet comes from the example config, but if you prepend the lines with <code>swaymsg</code> you get something you can run in a script. In the week or so I gave sway a drive, most of my configuring was done this way &#x2013; with a <code>swayrc</code> file containing <code>swaymsg</code> client calls &#x2013; the prospect of porting my comparably compact sxhkdrc file was annoying though. So, like the lazy programmer I am, I squinted at it a little bit and realized the sxhkd templating format looked a little&#x2026; <i>familiar</i>. It&rsquo;s supremely similar to shell templating!:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ echo foo{bar,baz}
foobar foobaz

$ echo {,fae}{bar,baz}
bar baz faebar faebaz

$ echo super+{_,shift,alt,ctrl}+{h,n,e,l}
super+_+h super+_+n super+_+e super+_+l super+shift+h super+shift+n super+shift+e super+shift+l super+alt+h super+alt+n super+alt+e super+alt+l super+ctrl+h super+ctrl+n super+ctrl+e super+ctrl+l
</pre>
</div>

<p>
Armed with this knowledge, I glued together something terrible for my <code>swayrc</code> file:
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #0065c8;">bind</span>() {
    <span style="color: #c6007f;">args</span>=(<span style="color: #007c00;">"$@"</span>)
    <span style="color: #0065c8;">for</span> i<span style="color: #0065c8;"> in</span> $(<span style="color: #c6007f;">seq 0 "$(( (${#args[@]} / 2</span><span style="color: #007c00;">) - 1 ))"</span>); <span style="color: #0065c8;">do</span>
        <span style="color: #c6007f;">key</span>=$(<span style="color: #c6007f;">echo "${args[$i]}" | sed 's/super/Mod4/' </span>)

        <span style="color: #c6007f;">val_index</span>=$(<span style="color: #c6007f;">( i + (${#args[@]} / 2</span>) ))
        <span style="color: #c6007f;">val</span>=${<span style="color: #c6007f;">args</span>[$<span style="color: #c6007f;">val_index</span>]}

        <span style="color: #0065c8;">echo</span> swaymsg bindsym <span style="color: #007c00;">"$key"</span> <span style="color: #007c00;">"$bindprefix$val"</span>
        swaymsg bindsym <span style="color: #007c00;">"$key"</span> <span style="color: #007c00;">"$bindprefix$val"</span>
    <span style="color: #0065c8;">done</span>
}

<span style="color: #6a6d6e;"># </span><span style="color: #6a6d6e;">bind exec</span>
<span style="color: #c6007f;">binde</span>() {
    <span style="color: #c6007f;">bindprefix</span>=<span style="color: #007c00;">'exec '</span> bind <span style="color: #007c00;">"$@"</span>
}
</pre>
</div>

<p>
And then, as long as I escaped the spaces to connect the terms, I could get away with this as my config:
</p>

<div class="org-src-container">
<pre class="src src-sh">binde super+{,shift+,alt+,ctrl+}{h,n,e,l} <span style="color: #007c00;">\</span>
    {focus,move,resize,presel}.sh<span style="color: #007c00;">\ </span>{west,south,north,east}
</pre>
</div>

<p>
Hooray!
</p>

<footer>
    <div style="float: left">
         <a href='https://notes.neeasade.net/tiled-wallpaper-sources.html'>newer: tiled wallpaper sources</a> 
    </div>
    <div style="text-align: right">
         <a href='https://notes.neeasade.net/tarps.html'>older: Myron Theme Palettes</a> 
    </div>
</footer>
<hr>
</main>
</body>
</html>
